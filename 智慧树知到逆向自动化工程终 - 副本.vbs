[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=20deaf04-9935-4ddc-b284-0fcaf6ad5de2
Description=智慧树知到逆向自动化工程终
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
DimEnv Access
Access = 0
//Global ADR1
DimEnv ADR2//调用extract后的shell地址 用于执行DOS
DimEnv APPROUTE//完整地址
Dimenv Code
Code = 0
//Event Form1.Button7.Click
//	
//Code = 455
//Call 启动APP
//End Event
Function 启动APP
Call ExtractPathSimplified//得到ADR2 shell的地址
Delay 1000
	Code = Form1.InputBox6.Text
//	MsgBox Code
	路径a = "D:&&CD " & ADR2
//    MsgBox 路径a
    命令行a = 路径a & "&&MuMuManager.exe api -v "& Code &" launch_app com.able.wisdomtree"
//命令行a = 路径a & "&&MuMuManager.exe api -v 0 launch_app com.able.wisdomtree"
//    MsgBox 命令行a
    Plugin.SMWH.GetDOS 命令行a, 20000
    
End Function

Event Form1.Button6.Click
	Code = Form1.InputBox6.Text
	Form1.ListBox2.AddItem Form1.InputBox6.Text
End Event

//DimEnv APPNAME
//APPNAME = "com.able.wisdomtree"
DimEnv M10携带码
M10携带码 = 0
DimEnv M2携带码
M2携带码 = 0
DimEnv M3携带码
M3携带码 = 0


DimEnv MODE
MODE = 0




//Event Form1.Button3.Click
//	Call CHANGE1
//End Event
//Function CHANGE1
//	MODE = 1
//    Dim LOGK1
//    LOGK1 = "MODE1 is chosen"
//    Form1.ListBox2.AddItem LOGK1
//    Form1.ListBox2.AddItem MODE
//End Function
//
//Event Form1.Button4.Click
//	Call CHANGE2
//End Event
//Function CHANGE2
//    MODE = 2
//    Dim LOGK2
//    LOGK2 = "MODE2 is chosen"
//    Form1.ListBox2.AddItem LOGK2
//    Form1.ListBox2.AddItem MODE
//End Function
//
//Event Form1.Button5.Click
//	Call CHANGE3
//End Event
//Function CHANGE3
//    MODE = 3
//    Dim LOGK3
//    LOGK3 = "MODE3 is chosen"
//    Form1.ListBox2.AddItem MODE
//End Function
//
Sub 加密
    //加密系统
//MsgBox "jiami"
    	TracePrint "Lib.HWSDK版本：" & Lib.HWSDK.LibVersion()

    	app_key = "icZ0d5kraKNjopgiNIci"// 填软件的AppKey
	
    	app_secret = "1tin0391stqvved4us051nomqm4u5unb"// 填软件的AppSecret
	
    	card = Form1.InputCard.Text// 界面输入后保存的卡密 
	
	
	
    	// 初始化
    	Call Lib.HWSDK.init(app_key, app_secret)
    	Call Lib.HWSDK.SetCard(card)
	
    	// 脚本停止事件
//		MsgBox "aaaa"
	
    	login = Lib.HWSDK.CardLogin()
    	If login(0) = 0 Then 
        	login_ret = Lib.HWSDK.GetLoginResult()
        	TracePrint "卡类：" & login_ret(0)
        	TracePrint "过期时间：" & login_ret(1)
        	TracePrint "过期时间戳：" & login_ret(2)
        	TracePrint "卡密配置：" & login_ret(3)
        	TracePrint "是否是试用：" & login_ret(4)
    		Access = 0
        	//进入变量修改
        	Call CHANGEAC
   	
            	TracePrint Access
        	Delay 2000
    	Else 
        	TracePrint "登录失败：" & login(1)
        	ExitScript
    	End If
	
    	w = 0
    	While True
        	//获取卡密剩余时间
        	tr = Lib.HWSDK.GetTimeRemaining()
        	TracePrint "当前剩余：" & tr & "秒"
        	//获取卡密心跳状态 非0 为不正常
        	hret = Lib.HWSDK.GetHeartbeatResult()
    	
        	If hret(0) <> 0 Then 
            	TracePrint "心跳错误"
            	Dim LOG2
            	LOG2 = "心跳错误"
            	Form1.ListBox1.AddItem LOG2
            	ExitScript 
        	Else 
            	TracePrint "心跳正常"
            	Dim LOG1
            	LOG1 = "心跳正常"
            	Form1.ListBox1.AddItem LOG1
	
        	End If
        	Delay 10000
        	w = w + 1
        	If w > 3 Then 
            	TracePrint "结束流程"
            	Dim LOG3
            	LOG3 = "流程结束"
            	Form1.ListBox1.AddItem LOG3
			
        	End If
    	Wend



End Sub

Function OnScriptExit()
    // 自动调用退出登录
    Call Lib.HWSDK.CardLogout()
End Function

Function CHANGEAC
	Access = 1
End Function

Function CHANGEADD
//	ADR2 = "D:\工程\MuMu Player 12\shell"//记录后续的adb接口路劲
//								
//    APPROUTE = "D:\工程\MuMu Player 12\shell\MuMuPlayer.exe"
	ADR2 = "D:\MuMu Player 12\shell"//记录后续的adb接口路劲
								
    APPROUTE = "D:\MuMu Player 12\shell\MuMuPlayer.exe"
End Function


Function Initiate
    TracePrint "Starting MuMu..."
    
	If Form1.BrowseBox1.Path = "" Then //如果路径为默认或空
//    If Form1.InputBox5.Text = "D:\工程\MuMu Player 12\shell\MuMuPlayer.exeK" or Form1.InputBox5.Text = "" Then //如果路径为默认或空
        ////////////////////////////////////////////////////////////////////
            Arr1 = lib.文件.遍历指定目录下所有文件夹名("D:\")
        For i0 = 0 To UBound(Arr1) - 1
            TracePrint Arr1(i0)
            If Arr1(i0) = "MuMu Player 12" Then 
//                		MsgBox "find gongc"
                Arr2 = Lib.文件.遍历指定目录下所有文件夹名("D:\MuMu Player 12\")
                For j0 = 0 To UBound(Arr2) - 1
                    TracePrint Arr2(j0)
                    If Arr2(j0) = "shell" Then 
//                        MsgBox "find mumu"
                        Arr3 = Lib.文件.遍历指定目录下所有文件名("D:\MuMu Player 12\shell\")
                        For k0 = 0 To UBound(Arr3) - 1
                            TracePrint Arr3(k0)
                            If Arr3(k0) = "MuMuPlayer.exe" Then 
//                            	MsgBox "MuMuPlayer.exe"
								Call CHANGEADD
                            	Goto ppp
                            ElseIf k0 = UBound(Arr3) - 1
                            	Dim FILEFAIL7
                        		FILEFAIL7 = "未找到exe"
                        		Form1.ListBox2.AddItem FILEFAIL7
                        		Dim FILEFAIL6
                        		FILEFAIL6 = "请重新设置路径"
                        		Form1.ListBox2.AddItem FILEFAIL6
                        		MsgBox "未找到exe"
                        		ExitScript 
                            Else
                            End If
                        Next
                    ElseIf j0 = UBound(Arr2) - 1
                        Dim FILEFAIL1
                        FILEFAIL1 = "未找到文件"
                        Form1.ListBox2.AddItem FILEFAIL1
                        Dim FILEFAIL4
                        FILEFAIL4 = "请重新设置路径"
                        Form1.ListBox2.AddItem FILEFAIL4
                        MsgBox "未找到文件"
                        ExitScript 
                    Else
                    End If
                Next
            ElseIf i0 = UBound(Arr1) - 1
                Dim FILEFAIL
                FILEFAIL = "未找到文件"
                Form1.ListBox2.AddItem FILEFAIL
                Dim FILEFAIL3
                FILEFAIL3 = "请重新设置路径"
                Form1.ListBox2.AddItem FILEFAIL3
                MsgBox "未找到文件"
                ExitScript 
            Else
            End If
		
        Next

		
        //////////////////////////////////////////////////////////////
    Else 
//        APPROUTE = Form1.InputBox5.Text
        APPROUTE = Form1.BrowseBox1.Path
        MsgBox "地址更改成功"
//        MsgBox APPROUTE
        //    	Delay 2000
    End If
    
    Rem ppp
//    MsgBox ADR2
//    MsgBox APPROUTE
    RunApp APPROUTE
    Delay 20000 ' 等待10秒，确保MuMu模拟器完全启动
    TracePrint "MuMu should be running now."
    
    Do
        HwndIni = Plugin.Window.Find("Qt5156QWindowIcon", "MuMu模拟器12")
        HwndIni1 = Plugin.Window.FindEx(HwndIni, 0, "Qt5156QWindowIcon", "MuMuPlayer")
        TracePrint HwndIni1
    Loop Until HwndIni1 <> 0
    Delay 8000
    //    MsgBox "MuMu should be running now."
End Function 

//Call Initiate
Global HD1,HD2,HD3//定义全局句柄
Sub Handle
    Dim Hwnd, HwndEx1, HwndEx2
    Hwnd = Plugin.Window.Find("Qt5156QWindowIcon", "MuMu模拟器12")
    HD1 = Hwnd
    HwndEx1 = Plugin.Window.FindEx(Hwnd, 0, "Qt5156QWindowIcon", "MuMuPlayer")
    HD2 = HwndEx1
    HwndEx2 = Plugin.Window.FindEx(HwndEx1, 0, "nemuwin", "nemudisplay")
    HD3 = HwndEx2
    Form1.ListBox1.AddItem Hwnd
    Form1.ListBox1.AddItem HwndEx1
    Form1.ListBox1.AddItem HwndEx2
    //	MsgBox HD1
    //	MsgBox HD2
    //	MsgBox HD3
    //改变窗口大小为(1920, 1080)
End Sub
Sub HP
    Call Plugin.Window.Size(HD1, 2560, 1440)
End Sub
//


Event Form1.Button2.Click
    //	p = 1
    //	MsgBox p
    StopThread 线程ID2
    Delay 2000
    Dim LOGEND
    LOGEND = "程序被终止"
    Form1.ListBox2.AddItem LOGEND
    MsgBox "程序被终止"
    ExitScript
End Event

//Sub 监测
//	Do
//		If p = 1 Then 
//			StopThread 线程ID2
//			Delay 2000
//			Dim LOGEND
//			LOGEND = "脚本被终止"
//			Form1.ListBox2.AddItem LOGEND
//			MsgBox "脚本被终止"
//			ExitScript
//		End If
//		Delay 2000
//	Loop until p = 1
//End Sub
//
DimEnv 线程ID1, 线程ID2, 线程ID3



Event Form1.Button1.Click
	
	//全释放
    PutAttachment "D:/按键精灵释放地址/", "未初始化Q1.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Q2.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Q3.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Q4.bmp"
    PutAttachment "D:/按键精灵释放地址/", "可播放.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化G1.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化G2.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化G3.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化G4.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化G5.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化G6.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化G7.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z1.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z2.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z3.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z4.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z5.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z6.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z7.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z8.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z9.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z10.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z11.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z12.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z13.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z14.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z15.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z16.bmp"
    PutAttachment "D:/按键精灵释放地址/", "未初始化Z17.bmp"

    //内部账号登录通道
    IDP = Form1.InputBox3.Text
    PASWOD = Form1.InputBox4.Text
    If IDP = "1" and PASWOD = "1" Then 
        Access = 2
        Dim LOG8
        LOG8 = "内部账号验证通过"
        Form1.ListBox2.AddItem LOG8
    Else 
        Access = 0
    End If
    //

    If Access = 2 Then 
        Goto 内部通道
    End If
    Dim LOG5,LOG6,LOG7
    LOG5 = "欢迎使用智慧树-知到逆向自动化工程"
    LOG6 = "版本号v1.0.1 作者：星马梦缘（李平安）"
    LOG7 = "登录系统启动中..."
    Form1.ListBox2.AddItem LOG5
    Form1.ListBox2.AddItem LOG6
    Form1.ListBox2.AddItem LOG7

//    登录判定
//MsgBox "call jm"
    线程ID1 = BeginThread(加密)
    Delay 10000
    MsgBox ACCESS
    	
    Rem 内部通道
    If Access = 1 or Access = 2 Then //如果Access通过
        MsgBox "Access"
        
        线程ID2 = BeginThread(执行)
        
        
        //	线程ID3 = BeginThread(监测)
        //	MsgBox 线程ID2
        //	MsgBox 线程ID3
    Else 
 		
        Dim LOG4
        LOG4 = "登录失败 流程停止"
        Form1.ListBox2.AddItem LOG4
        ExitScript
    End If

End Event
//



//
Sub 执行//由线程一控制
//	MsgBox Mode
	If Form1.OptionBox1.Value = 1 Then  
    MODE = 1
    Dim LOGK1
    LOGK1 = "MODE1 is chosen"
    Form1.ListBox2.AddItem LOGK1
    Form1.ListBox2.AddItem MODE  
ElseIf Form1.OptionBox2.Value = 1 Then  
    MODE = 2
    Dim LOGK2
    LOGK2 = "MODE2 is chosen"
    Form1.ListBox2.AddItem LOGK2
    Form1.ListBox2.AddItem MODE
ElseIf Form1.OptionBox3.Value = 1 Then
    MODE = 3
    Dim LOGK3
    LOGK3 = "MODE3 is chosen"
    Form1.ListBox2.AddItem LOGK3
    Form1.ListBox2.AddItem MODE
Else 
    MODE = 0
    Form1.ListBox2.AddItem MODE
End If  


    Call Initiate
    Call Handle
    Dim LOG9
    LOG9 = "句柄获取成功"
    Form1.ListBox2.AddItem LOG9
    Call HP
    Dim LOG10
    LOG10 = "分辨率初始化成功"
    Form1.ListBox2.AddItem LOG10
    
    Delay 3000
    
    Do
    XY广告 = Plugin.Bkgnd.FindColor(HD1, 1696, 146+200, 1754, 205+200, "FFBF02")
	ZB广告 = InStr(XY广告, "|")
	X广告 = Clng(Left(XY广告, ZB广告 - 1)): Y广告 = Clng(Right(XY广告, Len(XY广告) - ZB广告))
	
    XY0 = Plugin.Bkgnd.FindColor(HD1, 255, 486, 290, 501, "FFA300")
    ZB0 = InStr(XY0, "|")
    X0 = Clng(Left(XY0, ZB0 - 1)) : Y0 = Clng(Right(XY0, Len(XY0) - ZB0))
    TracePrint X0
    TracePrint Y0
        
    Loop Until X0 <> - 1  or X广告 <> - 1 
    
    If X广告 <> - 1  Then 
		Call Plugin.Bkgnd.LeftClick(HD2, 1729, 176)//点击下箭头
  		TracePrint X广告
  		TracePrint Y广告
		//	MsgBox "find"
	End If
	
	//更新热检测
	HwndK = Plugin.Window.Find("Qt5156QWindow", "MuMu更新")
    HDK = HwndK
    TracePrint HDK
    If HDK <> 0 Then 
    	Call Plugin.Bkgnd.LeftClick(HDK, 505, 556)//点击暂不更新
    	Dim LOG120
   		LOG120 = "暂不更新"
   		Form1.ListBox2.AddItem LOG120
//    	MsgBox "renew"
    End If

    Dim LOG11
    LOG11 = "检测到模拟器"
    Form1.ListBox2.AddItem LOG11
    //MsgBox "check"
	
    Delay 1000
    
// 	XY = Plugin.Bkgnd.FindColor(HD1, 198, 771, 1801, 1128, "0051FF")
//    ZB = InStr(XY, "|")
//    X = Clng(Left(XY, ZB - 1)) : Y = Clng(Right(XY, Len(XY) - ZB))
//    If X = - 1  Then 
//    	MsgBox "APP"
//    End If
    

    //启动软件
    Call 启动APP
    Dim LOG12
    LOG12 = "知到 启动！！！"
    Form1.ListBox2.AddItem LOG12
    
//    MsgBox ADR2

//报错处理
    //////////////
    //Do
    //    XY = Plugin.Bkgnd.FindColor(HD1, 198, 771, 1801, 1128, "0051FF")
    //    ZB = InStr(XY, "|")
    //    X = Clng(Left(XY, ZB - 1)): Y = Clng(Right(XY, Len(XY) - ZB))
    //    TracePrint X
    //    TracePrint Y
    //Loop Until X <> - 1 
    //
    //MsgBox "find"
    //
    //Delay 1000
    //Call Plugin.Bkgnd.LeftClick(HD2,482, 675)//点击图标
    //Call Plugin.Bkgnd.LeftClick(HD2, X, Y-251)//点击图标
    /////////////////////
//	MsgBox "test"
    Delay 10000
    Do
    	XYP1 = Plugin.Bkgnd.FindColorEx(HD1, 906, 124+200, 1060, 270+200, "EEC25F", 0, 0.8)
		ZBP1 = InStr(XYP1, "|")
		XP1 = Clng(Left(XYP1, ZBP1 - 1)) : YP1 = Clng(Right(XYP1, Len(XYP1) - ZBP1))
		
        XY检色 = Plugin.Bkgnd.FindColorEx(HD1, 1869, 310, 1871, 312, "2E2D2A", 0, 0.9)
		ZB检色 = InStr(XY检色, "|")
		X检色 = Clng(Left(XY检色, ZB检色 - 1)) : Y检色 = Clng(Right(XY检色, Len(XY检色) - ZB检色))
		Dim LOG201
    	LOG201 = "检色1"
    	Form1.ListBox2.AddItem LOG201
    Loop Until X检色 <> - 1  or XP1 <> - 1 
    
    

	Delay 1000
//	MsgBox "done"
	
	If XP1 <> - 1  Then 
//		MsgBox "cansel"
		Call Plugin.Bkgnd.LeftClick(HD2, 1237, 234)//点击取消
//		MsgBox "cancel"
	End If
	
	Delay 1000
	
	Do
        XY检色C = Plugin.Bkgnd.FindColorEx(HD1, 1702, 105+200, 1710, 120+200, "1A1918", 0, 0.9)
		ZB检色C = InStr(XY检色C, "|")
		X检色C = Clng(Left(XY检色C, ZB检色C - 1)) : Y检色C = Clng(Right(XY检色C, Len(XY检色C) - ZB检色C))
		Dim LOG209
    	LOG209 = "检色2"
    	Form1.ListBox2.AddItem LOG209
    Loop Until X检色C <> - 1 
	
	If X检色C <> - 1  Then 
		Delay 3000
    	Call Plugin.Bkgnd.LeftClick(HD2, 227, 122)//点击学习
	End If
    
    Delay 3000
//MsgBox "loopdie"

//	MsgBox MODE
    Dim LOG13
    LOG13 = "模式异化检测"
    Form1.ListBox2.AddItem LOG13
    //分类异化
    Select Case MODE
    Case 0
    	Dim LOGK4
    	LOGK4 = "NATURE MODE is chosen"
    	Form1.ListBox1.AddItem LOGK4
        Call 启动心理
    Case 1
        Call 启动心理
    Case 2
//    	MsgBox "sizheng"
        Call 启动思政
    Case 3
        Call 启动国防
    End Select

End SUb

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////心理心理心理心理心理心理心理心理心理心理心理心理心理心理心理心理心理//////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Function 启动心理
    Dim LOG14
    LOG14 = "心理课程自动化开始"
    Form1.ListBox2.AddItem LOG14
    //启动心理
///////////////////////////////////////////////////////////第七次更新内容
Call Handle
Call HP
	
	Do
	XYck = Plugin.Bkgnd.FindColorEx(HD1, 314, 754+200, 340, 787+200,"174FF9", 0, 0.9)//找考试的红点
	ZBck = InStr(XYck, "|")
	Xck = Clng(Left(XYck, ZBck - 1)) : Yck = Clng(Right(XYck, Len(XYck) - ZBck))
	Loop Until Xck <> - 1 //直到加载好
	
	Delay 700
	
	Call Plugin.Bkgnd.LeftClick(HD2, 894, 516)//点击按键
    Call Handle
	Call HP
	Call 滑动(Code, 440, 600, 450, 400, 1000)
	
	Delay 700
 
 
 
	XYxl = Plugin.Bkgnd.FindColorEx(HD1, 41, 358+200, 233, 1005+200, "4A3002", 0, 0.9)//寻找心理标志颜色
	ZBxl = InStr(XYxl, "|")
	Xxl = Clng(Left(XYxl, ZBxl - 1)): Yxl = Clng(Right(XYxl, Len(XYxl) - ZBxl))

	If Xxl <> - 1  Then 
		TracePrint Xxl
		TracePrint Yxl
		Call Plugin.Bkgnd.LeftClick(HD2, Xxl, Yxl)//点击按键
		
		//MsgBox "succ click"
	End If
/////////////////////////////////////////////////////////
    //MsgBox "click"
    
    
//MsgBox "index"

    Delay 5000
    Call 证书弹窗
    
    Delay 800
    Call 课终评价
    Delay 800
    
    //检测是否弹窗
    Dim LOG15
    LOG15 = "弹窗处理"
    Form1.ListBox2.AddItem LOG15
    
    //等到由白色箭头或者可点击为止
    
    Do 
    XYp2 = Plugin.Bkgnd.FindColorEx(HD1, 1108, 291, 1856, 448, "79DE69", 0, 0.8)
    ZBp2 = InStr(XYp2, "|")
    Xp2 = Clng(Left(XYp2, ZBp2 - 1)) : Yp2 = Clng(Right(XYp2, Len(XYp2) - ZBp2))
    
    XYp3 = Plugin.Bkgnd.FindColorEx(HD1, 23, 233, 67, 291, "FDFDFC",0,0.9)
    ZBp3 = InStr(XYp3, "|")
    Xp3 = Clng(Left(XYp3, ZBp3 - 1)) : Yp3 = Clng(Right(XYp3, Len(XYp3) - ZBp3))
    Loop Until Xp2 <> -1 or Xp3 <> -1
    
    If Xp2 <> - 1  Then 
        Delay 2000
        Call Plugin.Bkgnd.LeftClick(HD2, 983, 944)//点击下次再说
        //	Call Plugin.Bkgnd.LeftClick(HD2, 964, 864)//点击不再显示
        Delay 1000
    Else 
        //    Call Plugin.Bkgnd.LeftClick(HD2, 983, 944)//点击下次再说
//        MsgBox "Screenshut"
    End If
    //MsgBox "Screenshut"
    Delay 3000


    //找箭头
    Do
    XYp4 = Plugin.Bkgnd.FindColorEx(HD1, 23, 233, 67, 291, "FDFDFC",0,0.9)
    ZBp4 = InStr(XYp4, "|")
    Xp4 = Clng(Left(XYp4, ZBp4 - 1)) : Yp4 = Clng(Right(XYp4, Len(XYp4) - ZBp4))
    Loop Until Xp4 <> - 1 
        Delay 400
        Call Plugin.Bkgnd.LeftClick(HD2, 38, 57)//点击下箭头

    //
    Delay 2000
    /////////////////////////////////////////////////////////////

    Call 心理
End Function

Function 心理
	//检测人机
	线程ID3 = BeginThread(检测人机)

    //MsgBox "初始化开始"
    Dim LOG16
    LOG16 = "心理课程初始化"
    Form1.ListBox2.AddItem LOG16
    
    Call 初始化心理




    //统一大小
    Dim LOG21
    LOG21 = "遮挡处理"
   	Form1.ListBox2.AddItem LOG21
    Delay 1000

    Call Plugin.Bkgnd.LeftDown(HD2, 694, 1151)
    Delay 1000
    Call Plugin.Bkgnd.MoveTo(HD2, 485, 1140)
    Call Plugin.Bkgnd.LeftUp(HD2, 485, 1140)
    //
    Dim g
    g = 0
    Do
	
        Select Case g//遍历章节
        Case 0
        	Dim LOG22
    		LOG22 = "开始遍历心理绪论"
   			Form1.ListBox2.AddItem LOG22
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 473)//点击展开箭头1
            Delay 1000
        Case 1
        	Dim LOG23
    		LOG23 = "开始遍历心理章节一"
    		Form1.ListBox2.AddItem LOG23
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 547)//点击展开箭头2
            Delay 1000
        Case 2
        	Dim LOG24
    		LOG24 = "开始遍历心理章节二"
    		Form1.ListBox2.AddItem LOG24
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 621)//点击展开箭头3
            Delay 1000
        Case 3
        	Dim LOG25
    		LOG25 = "开始遍历心理章节三"
    		Form1.ListBox2.AddItem LOG25
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 694)//点击展开箭头4
            Delay 1000
        End Select
        //MsgBox "din1"

        Dim j//每一章都会初始化拖动次数
        j = 0
        TracePrint g

        Do

            Do
            	Delay 800
                XYB = Plugin.Bkgnd.FindPic(HD1, 512,252,736,1425, "D:\按键精灵释放地址\可播放.bmp", 0, 0.6)
                iZBB = InStr(XYB, "|")
                XB = CLng(Left(XYB, iZBB - 1))
                YB = CLng(Right(XYB, Len(XYB) - iZBB))
                If XB <> -1 Then 
                    TracePrint XB
                    TracePrint YB
                    Call Plugin.Bkgnd.LeftClick(HD2, XB+7,YB-52)//点击记忆隙间
                    //                MessageBox "kkk"
                    Dim LOG51
    				LOG51 = "开始播放"
    				Form1.ListBox2.AddItem LOG51
                    
                    Delay 1000
                    Call 视频浏览
                    Delay 1000
                Else 
                	Dim LOG26
    				LOG26 = "未找到可播放视频"
    				Form1.ListBox2.AddItem LOG26
	//           	MsgBox "NOfound"
                	TracePrint g
                End If
                Delay 1000
            Loop Until XB = - 1 //这一拖动层没有可播放的
            //向下拖动一页
//            	MsgBox "downd"
            TracePrint g
            Call 滑动(Code, 367, 1149, 381, 567, 1000)
            TracePrint g
            j = j + 1
//            MsgBox j
            Delay 1000
        Loop Until j = 3
        TracePrint g
        //回溯初始化
        For 3
            Call 滑动(Code, 381, 567, 367, 1149, 1000)
            Delay 300
        Next
        TracePrint g
        //
        Delay 1000

        Select Case g//返回章节选择
        Case 0
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 473)//点击展开箭头1
            Delay 1000
        Case 1
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 546)//点击展开箭头2
            Delay 1000
        Case 2
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 620)//点击展开箭头2
            Delay 1000
        Case 3
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 693)//点击展开箭头2
            Delay 1000
        End Select

        Delay 1000
        g = g + 1

    Loop Until g = 4

        Dim LOG27
    	LOG27 = "心理课程遍历完成"
    	Form1.ListBox2.AddItem LOG27
//    MsgBox "NEXT CURRICULUM"

    //四个章节都没有
    //去下一个课程
    
    Delay 800
    Call 课终评价
    Delay 800

//心理 
If MODE = 0 or MODE = 1 Then //心理优先组
        Dim LOG28
    	LOG28 = "切换至思政课"
    	Form1.ListBox2.AddItem LOG28
//	M10携带码 = 1
	Call 切换课程
	Call 启动思政
ElseIf MODE = 2 Then
		Dim LOG31
    	LOG31 = "切换至国防课"
    	Form1.ListBox2.AddItem LOG31
//	M2携带码 = 2
	Call 切换课程
	Call 启动国防
Else 
		Dim LOG32
    	LOG32 = "切换至思政课"
    	Form1.ListBox2.AddItem LOG32
//	M3携带码 = 2
	Call 切换课程
	Call 启动思政
End If

End Function

Sub 初始化心理


    Delay 1000
    //    MsgBox "wait"
    XYt0 = Plugin.Bkgnd.FindPic(HD1, 9,490,63,600, "D:\按键精灵释放地址\未初始化Q1.bmp", 0, 0.6)
    iZBt0 = InStr(XYt0, "|")
    Xt0 = CLng(Left(XYt0, iZBt0 - 1))
    Yt0 = CLng(Right(XYt0, Len(XYt0) - iZBt0))
    If Xt0 <> - 1  Then 
        TracePrint Xt0
        TracePrint Yt0
        //        	MsgBox "wait"
        Call Plugin.Bkgnd.LeftClick(HD2, 31,469)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ1"
    End If
    
    Dim LOG17
    LOG17 = "心理绪论已还原"
   	Form1.ListBox2.AddItem LOG17

    Delay 1000

    XYt = Plugin.Bkgnd.FindPic(HD1, 9,490,63,868, "D:\按键精灵释放地址\未初始化Q2.bmp", 0, 0.6)
    iZBt = InStr(XYt, "|")
    Xt = CLng(Left(XYt, iZBt - 1))
    Yt = CLng(Right(XYt, Len(XYt) - iZBt))
    //XY = Plugin.Bkgnd.FindColor(HD1, 0, 0, 1024, 768, "797764")
    //ZB = InStr(XY, "|")
    //X = Clng(Left(XY, ZB - 1)): Y = Clng(Right(XY, Len(XY) - ZB))

    If Xt <> - 1  Then //有
        TracePrint Xt 
        TracePrint Yt
        Call Plugin.Bkgnd.LeftClick(HD2, 30,547)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ2"
    End If
    
    Dim LOG18
    LOG18 = "心理章节一已还原"
   	Form1.ListBox2.AddItem LOG18

    Delay 1000

    XYt1 = Plugin.Bkgnd.FindPic(HD1, 9,490,63,868, "D:\按键精灵释放地址\未初始化Q3.bmp", 0, 0.8)
    iZBt1 = InStr(XYt1, "|")
    Xt1 = CLng(Left(XYt1, iZBt1 - 1))
    Yt1 = CLng(Right(XYt1, Len(XYt1) - iZBt1))
    If Xt1 <> - 1  Then 
        TracePrint Xt1
        TracePrint Yt1
        Call Plugin.Bkgnd.LeftClick(HD2, 31,618)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ3"
    End If
    
    Dim LOG19
    LOG19 = "心理章节二已还原"
   	Form1.ListBox2.AddItem LOG19

    Delay 1000

    XYt2 = Plugin.Bkgnd.FindPic(HD1, 9,490,63,868, "D:\按键精灵释放地址\未初始化Q4.bmp", 0, 0.6)
    iZBt2 = InStr(XYt2, "|")
    Xt2 = CLng(Left(XYt2, iZBt2 - 1))
    Yt2 = CLng(Right(XYt2, Len(XYt2) - iZBt2))
    If Xt2 <> - 1  Then 
        TracePrint Xt2
        TracePrint Yt2
        Call Plugin.Bkgnd.LeftClick(HD2, 31,693)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ4"
    End If
    
    Dim LOG20
    LOG20 = "心理章节三已还原"
   	Form1.ListBox2.AddItem LOG20
End Sub

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////思政思政思政思政思政思政思政思政思政思政思政思政思政思政思政思政思政//////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Function 启动思政
	Dim LOG33
    LOG33 = "思政课程自动化开始"
    Form1.ListBox2.AddItem LOG33
//	MsgBox "in sz"
    //启动思政
//Do
//
//	XY课程 = Plugin.Bkgnd.FindColor(HD1, 187, 825, 383, 956+52, "3DC9FD")
//	ZB课程 = InStr(XY课程, "|")
//	X课程 = Clng(Left(XY课程, ZB课程 - 1)) : Y课程 = Clng(Right(XY课程, Len(XY课程) - ZB课程))
//
//	XYsz = Plugin.Bkgnd.FindColorEx(HD1, 399, 622+200, 523, 657+200, "89D700", 0, 0.9)
//	ZBsz = InStr(XYsz, "|")
//	Xsz = Clng(Left(XYsz, ZBsz - 1)) : Ysz = Clng(Right(XYsz, Len(XYsz) - ZBsz))
//Loop Until X课程 <> - 1  or Xsz <> - 1 
//
//    Delay 800
//    Call Plugin.Bkgnd.LeftClick(HD2, 140, 867)//点击课程播放


///////////////////////////////////////////////////////////第七次更新内容
Call Handle
Call HP
	
	Do
	XYck = Plugin.Bkgnd.FindColorEx(HD1, 314, 754+200, 340, 787+200,"174FF9", 0, 0.9)//找考试的红点
	ZBck = InStr(XYck, "|")
	Xck = Clng(Left(XYck, ZBck - 1)) : Yck = Clng(Right(XYck, Len(XYck) - ZBck))
	Loop Until Xck <> - 1 //直到加载好
	
	Delay 700
	
	Call Plugin.Bkgnd.LeftClick(HD2, 894, 516)//点击按键
    Call Handle
	Call HP
	Call 滑动(Code, 440, 600, 450, 400, 1000)
	
	Delay 700
 
 
 
	XYszz = Plugin.Bkgnd.FindColorEx(HD1, 41, 358+200, 233, 1005+200, "C44D4A", 0, 0.9)//寻找思政标志颜色
	ZBszz = InStr(XYszz, "|")
	Xszz = Clng(Left(XYszz, ZBszz - 1)): Yszz = Clng(Right(XYszz, Len(XYszz) - ZBszz))

	If Xszz <> - 1  Then 
		TracePrint Xszz
		TracePrint Yszz
		Call Plugin.Bkgnd.LeftClick(HD2, Xszz, Yszz-200)//点击按键
		
		//MsgBox "succ click"
	End If
/////////////////////////////////////////////////////////


    Delay 5000
    Call 证书弹窗
    
    Delay 800
    Call 课终评价
    Delay 800
    
    Dim LOG34
    LOG34 = "弹窗处理"
    Form1.ListBox2.AddItem LOG34
    //检测是否弹窗
    Do
    XYG2 = Plugin.Bkgnd.FindColorEx(HD1, 1108, 291, 1856, 448, "79DE69", 0, 0.8)
    ZBG2 = InStr(XYG2, "|")
    XG2 = Clng(Left(XYG2, ZBG2 - 1)) : YG2 = Clng(Right(XYG2, Len(XYG2) - ZBG2))
    
    XYG3 = Plugin.Bkgnd.FindColorEx(HD1, 23, 233, 67, 291, "FDFDFC",0,0.9)
    ZBG3 = InStr(XYG3, "|")
    XG3 = Clng(Left(XYG3, ZBG3 - 1)) : YG3 = Clng(Right(XYG3, Len(XYG3) - ZBG3))
    Loop Until XG2 <> - 1  or XG3 <> - 1 
    
    If XG2 <> - 1  Then 
        Delay 2000
        Call Plugin.Bkgnd.LeftClick(HD2, 983, 944)//点击下次再说
        //	Call Plugin.Bkgnd.LeftClick(HD2, 964, 864)//点击不再显示
        Delay 1000
    Else 
        //    Call Plugin.Bkgnd.LeftClick(HD2, 983, 944)//点击下次再说
    End If
    //MsgBox "Screenshut"
    Delay 3000


    //找箭头
    Do
    XYp4 = Plugin.Bkgnd.FindColorEx(HD1, 23, 233, 67, 291, "FDFDFC",0,0.9)
    ZBp4 = InStr(XYp4, "|")
    Xp4 = Clng(Left(XYp4, ZBp4 - 1)) : Yp4 = Clng(Right(XYp4, Len(XYp4) - ZBp4))
    Loop Until Xp4 <> - 1 
        Delay 400
        Call Plugin.Bkgnd.LeftClick(HD2, 38, 57)//点击下箭头
    //
    Delay 2000

    Call 思政
End Function

Function 思政
	//检测人机
	线程ID3 = BeginThread(检测人机)
//Goto sze
	Dim LOG35
    LOG35 = "思政课程初始化"
    Form1.ListBox2.AddItem LOG35
    
    Call 初始化思政
	
    Delay 1000
    //没有AI
    //Call Plugin.Bkgnd.LeftDown(HD2, 694, 1151)
    //Delay 1000
    //Call Plugin.Bkgnd.MoveTo(HD2, 485, 1140)
    //Call Plugin.Bkgnd.LeftUp(HD2, 485, 1140)
    //
    Dim s
    s = 0
    Do
	
        Select Case s//遍历章节
        Case 0
        	Dim LOG42
    		LOG42 = "开始遍历思政绪论"
    		Form1.ListBox2.AddItem LOG42
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 473)//点击展开箭头1
            Delay 1000
        Case 1
        	Dim LOG43
    		LOG43 = "开始遍历思政章节一"
    		Form1.ListBox2.AddItem LOG43
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 547)//点击展开箭头2
            Delay 1000
        Case 2
        	Dim LOG44
    		LOG44 = "开始遍历思政章节二"
    		Form1.ListBox2.AddItem LOG44
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 621)//点击展开箭头3
            Delay 1000
        Case 3
        	Dim LOG45
    		LOG45 = "开始遍历思政章节三"
    		Form1.ListBox2.AddItem LOG45
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 694)//点击展开箭头4
            Delay 1000
        Case 4
        	Dim LOG46
    		LOG46 = "开始遍历思政章节四"
    		Form1.ListBox2.AddItem LOG46
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 767)//点击展开箭头5
            Delay 1000
        Case 5
        	Dim LOG47
    		LOG47 = "开始遍历思政章节五"
    		Form1.ListBox2.AddItem LOG47
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 838)//点击展开箭头6
            Delay 1000
        Case 6
        	Dim LOG48
    		LOG48 = "开始遍历思政章节六"
    		Form1.ListBox2.AddItem LOG48
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 913)//点击展开箭头7
            Delay 1000
        End Select
        //MsgBox "din1"

        Dim h//每一章都会初始化拖动次数
        h = 0
        TracePrint s

        Do

            Do
                XYGB = Plugin.Bkgnd.FindPic(HD1, 568,252,736,1425, "D:\按键精灵释放地址\可播放.bmp", 0, 0.5)
                iZBGB = InStr(XYGB, "|")
                XGB = CLng(Left(XYGB, iZBGB - 1))
                YGB = CLng(Right(XYGB, Len(XYGB) - iZBGB))
                If XGB <> -1 Then 
                    TracePrint XGB
                    TracePrint YGB
                    Call Plugin.Bkgnd.LeftClick(HD2, XGB+7,YGB-52)//点击记忆隙间
//                    MessageBox "kkk"
					Dim LOG49
    				LOG49 = "开始播放"
    				Form1.ListBox2.AddItem LOG49
    				
                    Delay 1000
                    Call 视频浏览
                    Delay 1000
                Else 
                	Dim LOG50
    				LOG50 = "未找到可播放视频"
    				Form1.ListBox2.AddItem LOG50
                    //                		MsgBox "NOfound"
                    TracePrint s
                End If
                Delay 1000
            Loop Until XGB = - 1 //这一拖动层没有可播放的
            //向下拖动一页
            //	MsgBox "edlop"
            TracePrint s
            Call 滑动(Code, 367, 1149, 381, 567, 1000)
            TracePrint s
            h = h + 1
            Delay 1000
        Loop Until h = 5
        TracePrint s
        //回溯初始化
        For 4
            Call 滑动(Code, 381, 567, 367, 1149, 1000)
            Delay 300
        Next
        TracePrint s
        //
        Delay 1000

        Select Case s//返回章节选择
        Case 0
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 473)//点击展开箭头1
//            MsgBox "click arr1"
            Delay 1000
        Case 1
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 546)//点击展开箭头2
//            MsgBox "click arr2"
            Delay 1000
        Case 2
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 620)//点击展开箭头2
            Delay 1000
        Case 3
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 693)//点击展开箭头2
            Delay 1000
        Case 4
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 767)//点击展开箭头2
            Delay 1000
        Case 5
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 838)//点击展开箭头2
            Delay 1000
        Case 6
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 967)//点击展开箭头2
            Delay 1000
        End Select

        Delay 1000
        s = s + 1

    Loop Until s = 7
Rem sze
//    MsgBox "NEXT CURRICULUM"
    Dim LOG52
    LOG52 = "思政课程遍历完成"
    Form1.ListBox2.AddItem LOG52
    
    Delay 800
    Call 课终评价
    Delay 800

    //zhu
    //四个章节都没有
    //去下一个课程
//	MsgBox MODE
//思政
If MODE = 0 or MODE = 1 Then //思政优先组
	Dim LOG53
    LOG53 = "切换至国防课"
    Form1.ListBox2.AddItem LOG53
//	M10携带码 = 2
	Call 切换课程
	Call 启动国防
ElseIf MODE = 2 Then
	Dim LOG54
    LOG54 = "切换至心理课"
    Form1.ListBox2.AddItem LOG54
//	M2携带码 = 1
	Call 切换课程
	Call 启动心理
Else 
	Dim LOG55
    LOG55 = "MODE3自动化已完成"
    Form1.ListBox2.AddItem LOG55
    
    Dim LOG56
    LOG56 = "感谢您选择智慧树-知到自动化逆向工程"
    Form1.ListBox2.AddItem LOG56
//	M3携带码 = 3
	Delay 1000
	//关闭模拟器
	Call 关闭模拟器	
	StopThread 线程ID2
	Delay 2000
	Dim LOGEND2
	LOGEND2 = "程序终止"
	Form1.ListBox2.AddItem LOGEND2
	MsgBox "程序终止"
	ExitScript
End If

	
	
End Function

Sub 初始化思政


    Delay 1000
    //    MsgBox "wait"
    XYGt0 = Plugin.Bkgnd.FindPic(HD1, 9,490,63,600, "D:\按键精灵释放地址\未初始化G1.bmp", 0, 0.6)
    iZBGt0 = InStr(XYGt0, "|")
    XGt0 = CLng(Left(XYGt0, iZBGt0 - 1))
    YGt0 = CLng(Right(XYGt0, Len(XYGt0) - iZBGt0))
    If XGt0 <> - 1  Then 
        TracePrint XGt0
        TracePrint YGt0
        //        	MsgBox "wait"
        Call Plugin.Bkgnd.LeftClick(HD2, 31,469)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ1"
    End If
    
    Dim LOG36
    LOG36 = "思政绪论已还原"
    Form1.ListBox2.AddItem LOG36

    Delay 1000

    XYGt = Plugin.Bkgnd.FindPic(HD1, 9,490,63,868, "D:\按键精灵释放地址\未初始化G2.bmp", 0, 0.6)
    iZBGt = InStr(XYGt, "|")
    XGt = CLng(Left(XYGt, iZBGt - 1))
    YGt = CLng(Right(XYGt, Len(XYGt) - iZBGt))
    //XY = Plugin.Bkgnd.FindColor(HD1, 0, 0, 1024, 768, "797764")
    //ZB = InStr(XY, "|")
    //X = Clng(Left(XY, ZB - 1)): Y = Clng(Right(XY, Len(XY) - ZB))

    If XGt <> - 1  Then //有
        TracePrint XGt 
        TracePrint YGt
        Call Plugin.Bkgnd.LeftClick(HD2, 30,547)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ2"
    End If
    
    Dim LOG37
    LOG37 = "思政章节一已还原"
    Form1.ListBox2.AddItem LOG37

    Delay 1000

    XYGt1 = Plugin.Bkgnd.FindPic(HD1, 9,490,63,968, "D:\按键精灵释放地址\未初始化G3.bmp", 0, 0.6)
    iZBGt1 = InStr(XYGt1, "|")
    XGt1 = CLng(Left(XYGt1, iZBGt1 - 1))
    YGt1 = CLng(Right(XYGt1, Len(XYGt1) - iZBGt1))
    If XGt1 <> - 1  Then 
        TracePrint XGt1
        TracePrint YGt1
        Call Plugin.Bkgnd.LeftClick(HD2, 31,618)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ3"
    End If
    
    Dim LOG38
    LOG38 = "思政章节二已还原"
    Form1.ListBox2.AddItem LOG38

    Delay 1000

    XYGt2 = Plugin.Bkgnd.FindPic(HD1, 9,490,63,968, "D:\按键精灵释放地址\未初始化G4.bmp", 0, 0.6)
    iZBGt2 = InStr(XYGt2, "|")
    XGt2 = CLng(Left(XYGt2, iZBGt2 - 1))
    YGt2 = CLng(Right(XYGt2, Len(XYGt2) - iZBGt2))
    If XGt2 <> - 1  Then 
        TracePrint XGt2
        TracePrint YGt2
        Call Plugin.Bkgnd.LeftClick(HD2, 31,693)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ4"
    End If
    
    Dim LOG39
    LOG39 = "思政章节三已还原"
    Form1.ListBox2.AddItem LOG39
    
    
    Delay 1000

    XYGt3 = Plugin.Bkgnd.FindPic(HD1, 9,490,63,968, "D:\按键精灵释放地址\未初始化G5.bmp", 0, 0.6)
    iZBGt3 = InStr(XYGt3, "|")
    XGt3 = CLng(Left(XYGt3, iZBGt3 - 1))
    YGt3 = CLng(Right(XYGt3, Len(XYGt3) - iZBGt3))
    If XGt3 <> - 1  Then 
        TracePrint XGt3
        TracePrint YGt3
        Call Plugin.Bkgnd.LeftClick(HD2, 31,765)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ5"
    End If
    
    Dim LOG40
    LOG40 = "思政章节四已还原"
    Form1.ListBox2.AddItem LOG40
        
    Delay 1000

    XYGt4 = Plugin.Bkgnd.FindPic(HD1, 9,490,63,968, "D:\按键精灵释放地址\未初始化G6.bmp", 0, 0.6)
    iZBGt4 = InStr(XYGt4, "|")
    XGt4 = CLng(Left(XYGt4, iZBGt4 - 1))
    YGt4 = CLng(Right(XYGt4, Len(XYGt4) - iZBGt4))
    If XGt4 <> - 1  Then 
        TracePrint XGt4
        TracePrint YGt4
        Call Plugin.Bkgnd.LeftClick(HD2, 31,840)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ6"
    End If
    
    Dim LOG41
    LOG41 = "思政章节五已还原"
    Form1.ListBox2.AddItem LOG41
    
    Delay 1000

    XYGt5 = Plugin.Bkgnd.FindPic(HD1, 9,490,83,1200, "D:\按键精灵释放地址\未初始化G7.bmp", 0, 0.6)
    iZBGt5 = InStr(XYGt5, "|")
    XGt5 = CLng(Left(XYGt5, iZBGt5 - 1))
    YGt5 = CLng(Right(XYGt5, Len(XYGt5) - iZBGt5))
    If XGt5 <> - 1  Then 
        TracePrint XGt5
        TracePrint YGt5
        Call Plugin.Bkgnd.LeftClick(HD2, 31,912)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ7"
    End If
    
    Dim LOG42
    LOG42 = "思政章节五已还原"
    Form1.ListBox2.AddItem LOG42
    
End Sub
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////国防国防国防国防国防国防国防国防国防国防国防国防国防国防国防国防国防//////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Function 启动国防
	Dim LOG57
    LOG57 = "国防课程自动化开始"
    Form1.ListBox2.AddItem LOG57
    //启动国防
//    Do
//        GetColorZ1 = Plugin.Bkgnd.GetPixelColor(HD1, 64, 1280)
//        TracePrint GetcolorZ1
//    Loop Until GetColorZ1 = "0C0956"
//    Delay 800
//    Call Plugin.Bkgnd.LeftClick(HD2, 550, 1072)//点击课程播放
//Do
//	XY课程1 = Plugin.Bkgnd.FindColor(HD1, 33, 1247, 230, 1090+200, "100C5A")
//	ZB课程1 = InStr(XY课程1, "|")
//	X课程1 = Clng(Left(XY课程1, ZB课程1 - 1)) : Y课程1 = Clng(Right(XY课程1, Len(XY课程1) - ZB课程1))
//
//	XYgf = Plugin.Bkgnd.FindColorEx(HD1, 399, 622+200, 523, 657+200, "89D700", 0, 0.9)
//	ZBgf = InStr(XYgf, "|")
//	Xgf = Clng(Left(XYgf, ZBgf - 1)) : Ygf = Clng(Right(XYgf, Len(XYgf) - ZBgf))
//Loop Until X课程1 <> - 1  or Xgf <> - 1 
//
//   Delay 800
//    Call Plugin.Bkgnd.LeftClick(HD2, 550, 1072)//点击课程播放

///////////////////////////////////////////////////////////第七次更新内容
Call Handle
Call HP
	
	Do
	XYck = Plugin.Bkgnd.FindColorEx(HD1, 314, 754+200, 340, 787+200,"174FF9", 0, 0.9)//找考试的红点
	ZBck = InStr(XYck, "|")
	Xck = Clng(Left(XYck, ZBck - 1)) : Yck = Clng(Right(XYck, Len(XYck) - ZBck))
	Loop Until Xck <> - 1 //直到加载好
	
	Delay 700
	
	Call Plugin.Bkgnd.LeftClick(HD2, 894, 516)//点击按键
    Call Handle
	Call HP
	Call 滑动(Code, 440, 600, 450, 400, 1000)
	
	Delay 700
 
 
 
	XYgff = Plugin.Bkgnd.FindColorEx(HD1, 41, 358+200, 233, 1005+200, "364AE2", 0, 0.9)//寻找国防标志颜色
	ZBgff = InStr(XYgff, "|")
	Xgff = Clng(Left(XYgff, ZBgff - 1)): Ygff = Clng(Right(XYgff, Len(XYgff) - ZBgff))

	If Xgff <> - 1  Then 
		TracePrint Xgff
		TracePrint Ygff
		Call Plugin.Bkgnd.LeftClick(HD2, Xgff, Ygff-200)//点击按键
		
		//MsgBox "succ click"
	End If
/////////////////////////////////////////////////////////

    Delay 5000
    Call 证书弹窗
    
    Delay 800
    Call 课终评价
    Delay 800
    
    Dim LOG58
    LOG58 = "弹窗处理"
    Form1.ListBox2.AddItem LOG58
    //检测是否弹窗
    Do
    XYZ2 = Plugin.Bkgnd.FindColorEx(HD1, 1108, 291, 1856, 448, "79DE69", 0, 0.8)
    ZBZ2 = InStr(XYZ2, "|")
    XZ2 = Clng(Left(XYZ2, ZBZ2 - 1)) : YZ2 = Clng(Right(XYZ2, Len(XYZ2) - ZBZ2))
    
    XYZ3 = Plugin.Bkgnd.FindColorEx(HD1, 23, 233, 67, 291, "FDFDFC",0,0.9)
    ZBZ3 = InStr(XYZ3, "|")
    XZ3 = Clng(Left(XYZ3, ZBZ3 - 1)) : YZ3 = Clng(Right(XYZ3, Len(XYZ3) - ZBZ3))
    Loop Until XZ2 <> - 1  or XZ3 <> - 1 

    If XZ2 <> - 1  Then 
        Delay 2000
        Call Plugin.Bkgnd.LeftClick(HD2, 983, 944)//点击下次再说
        //	Call Plugin.Bkgnd.LeftClick(HD2, 964, 864)//点击不再显示
        Delay 1000
    Else 
        //    Call Plugin.Bkgnd.LeftClick(HD2, 983, 944)//点击下次再说
    End If
    //MsgBox "Screenshut"
    Delay 3000


    //找箭头
    Do
    XYp4 = Plugin.Bkgnd.FindColorEx(HD1, 23, 233, 67, 291, "FDFDFC",0,0.9)
    ZBp4 = InStr(XYp4, "|")
    Xp4 = Clng(Left(XYp4, ZBp4 - 1)) : Yp4 = Clng(Right(XYp4, Len(XYp4) - ZBp4))
    Loop Until Xp4 <> - 1 
        Delay 400
        Call Plugin.Bkgnd.LeftClick(HD2, 38, 57)//点击下箭头
    //
    Delay 2000

    Call 国防
End Function

Function 国防
	//检测人机
	线程ID3 = BeginThread(检测人机)
	Dim LOG59
    LOG59 = "国防课程初始化"
    Form1.ListBox2.AddItem LOG59

    Call 初始化国防
	
    Delay 1000
	
    //拖动到最上方
    For 2
        Call 滑动(Code, 381, 567, 367, 1149, 1000)
        Delay 1000
    Next
    //有AI
    Dim LOG77
    LOG77 = "遮挡处理"
    Form1.ListBox2.AddItem LOG77
    
    Call Plugin.Bkgnd.LeftDown(HD2, 694, 1151)
    Delay 1000
    Call Plugin.Bkgnd.MoveTo(HD2, 485, 1140)
    Call Plugin.Bkgnd.LeftUp(HD2, 485, 1140)
    //
    Dim f
    f = 0
    Do
	
        Select Case f//遍历章节
        Case 0
        	Dim LOG78
    		LOG78 = "开始遍历章节一"
    		Form1.ListBox2.AddItem LOG78
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 473)//点击展开箭头1
            Delay 1000
        Case 1
        	Dim LOG79
    		LOG79 = "开始遍历章节二"
    		Form1.ListBox2.AddItem LOG79
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 547)//点击展开箭头2
            Delay 1000
        Case 2
        	Dim LOG80
    		LOG80 = "开始遍历章节三"
    		Form1.ListBox2.AddItem LOG80
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 621)//点击展开箭头3
            Delay 1000
        Case 3
        	Dim LOG81
    		LOG81 = "开始遍历章节四"
    		Form1.ListBox2.AddItem LOG81
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 694)//点击展开箭头4
            Delay 1000
        Case 4
        	Dim LOG82
    		LOG82 = "开始遍历章节五"
    		Form1.ListBox2.AddItem LOG82
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 767)//点击展开箭头5
            Delay 1000
        Case 5
        	Dim LOG83
    		LOG83 = "开始遍历章节六"
    		Form1.ListBox2.AddItem LOG83
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 838)//点击展开箭头6
            Delay 1000
        Case 6
        	Dim LOG84
    		LOG84 = "开始遍历章节七"
    		Form1.ListBox2.AddItem LOG84
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 913)//点击展开箭头7
            Delay 1000
        Case 7
        	Dim LOG85
    		LOG85 = "开始遍历章节八"
    		Form1.ListBox2.AddItem LOG85
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 985)//点击展开箭头8
            Delay 1000
        Case 8
        	Dim LOG86
    		LOG86 = "开始遍历章节九"
    		Form1.ListBox2.AddItem LOG86
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 1057)//点击展开箭头9
            Delay 1000
        Case 9
        	Dim LOG87
    		LOG87 = "开始遍历章节十"
    		Form1.ListBox2.AddItem LOG87
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 1138)//点击展开箭头10
            Delay 1000
        Case 10
        	Dim LOG88
    		LOG88 = "开始遍历章节十一"
    		Form1.ListBox2.AddItem LOG88
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 1204)//点击展开箭头11
            Delay 1000
        Case 11
        	Dim LOG89
    		LOG89 = "开始遍历章节十二"
    		Form1.ListBox2.AddItem LOG89
            Call 滑动(Code, 367, 1149, 381, 567, 1000)//滑倒最下面
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 831)//点击展开箭头12
            Delay 1000
        Case 12
        	Dim LOG90
    		LOG90 = "开始遍历章节十三"
    		Form1.ListBox2.AddItem LOG90
            Call 滑动(Code, 367, 1149, 381, 567, 1000)//滑倒最下面
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 903)//点击展开箭头13
            Delay 1000
        Case 13
        	Dim LOG91
    		LOG91 = "开始遍历章节十四"
    		Form1.ListBox2.AddItem LOG91
            Call 滑动(Code, 367, 1149, 381, 567, 1000)//滑倒最下面
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 974)//点击展开箭头14
            Delay 1000
        Case 14
        	Dim LOG92
    		LOG92 = "开始遍历章节十五"
    		Form1.ListBox2.AddItem LOG92
            Call 滑动(Code, 367, 1149, 381, 567, 1000)//滑倒最下面
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 1049)//点击展开箭头15
            Delay 1000
        Case 15
        	Dim LOG93
    		LOG93 = "开始遍历章节十六"
    		Form1.ListBox2.AddItem LOG93
            Call 滑动(Code, 367, 1149, 381, 567, 1000)//滑倒最下面
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 1120)//点击展开箭头16
            Delay 1000
        Case 16
        	Dim LOG94
    		LOG94 = "开始遍历章节十七"
    		Form1.ListBox2.AddItem LOG94
            Call 滑动(Code, 367, 1149, 381, 567, 1000)//滑倒最下面
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 26, 1195)//点击展开箭头17
            Delay 1000
        End Select
        //MsgBox "din1"

        Dim u//每一章都会初始化拖动次数
        u = 0

        Do

            Do
                XYZB = Plugin.Bkgnd.FindPic(HD1, 568,252,736,1425, "D:\按键精灵释放地址\可播放.bmp", 0, 0.5)
                iZBZB = InStr(XYZB, "|")
                XZB = CLng(Left(XYZB, iZBZB - 1))
                YZB = CLng(Right(XYZB, Len(XYZB) - iZBZB))
                If XZB <> -1 Then 
                    TracePrint XZB
                    TracePrint YZB
                    Call Plugin.Bkgnd.LeftClick(HD2, XZB+7,YZB-52)//点击记忆隙间
//                    MessageBox "kkk"
					Dim LOG95
    				LOG95 = "开始播放"
    				Form1.ListBox2.AddItem LOG95

                    Delay 1000
                    Call 视频浏览
                    Delay 1000
                Else 
                	Dim LOG96
    				LOG96 = "未找到可播放视频"
    				Form1.ListBox2.AddItem LOG96
//                    MsgBox "NOfound"
                End If
                Delay 1000
            Loop Until XZB = - 1 //这一拖动层没有可播放的
            //向下拖动一页
            //	MsgBox "edlop"

            If f < 11 Then
                Call 滑动(Code, 367, 1149, 381, 567, 1000)
                Delay 1000
            Else 
                Call 滑动(Code, 367, 1149, 381, 567, 1000)
                Delay 1000
                //如果大于11 即第12章起就向下划了 章节很短
            End If

        
            u = u + 1
            Delay 1000
        
        Loop Until u = 4//拖几次

        //回溯初始化
        If f < 11 Then 
            For 3
                Call 滑动(Code, 381, 567, 367, 1149, 1000)
                Delay 1000
            Next
        Else //大于11就不要回溯 直接滑到最下端
            Call 滑动(Code, 367, 1149, 381, 567, 1000)
            Delay 1000
        End If

        Select Case f//返回章节选择
        Case 0
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 473)//点击展开箭头1
            Delay 1000
        Case 1
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 546)//点击展开箭头2
            Delay 1000
        Case 2
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 620)//点击展开箭头3
            Delay 1000
        Case 3
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 693)//点击展开箭头4
            Delay 1000
        Case 4
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 767)//点击展开箭头5
            Delay 1000
        Case 5
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 838)//点击展开箭头6
            Delay 1000
        Case 6
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 913)//点击展开箭头7
            Delay 1000
        Case 7
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 985)//点击展开箭头8
            Delay 1000
        Case 8
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 1057)//点击展开箭头9
            Delay 1000
        Case 9
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 1138)//点击展开箭头10
            Delay 1000
        Case 10
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 1204)//点击展开箭头11  1204
            Delay 1000
        Case 11//已经划到最下方了 此时为点开状态
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 555)//点击展开箭头12
            Delay 1000
        Case 12
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 553)//点击展开箭头13
            Delay 1000
        Case 13
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 699)//点击展开箭头14
            Delay 1000
        Case 14
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 772)//点击展开箭头15
            Delay 1000
        Case 15
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 775)//点击展开箭头16
            Delay 1000
        Case 16
            Delay 1000
            Call Plugin.Bkgnd.LeftClick(HD2, 30, 846)//点击展开箭头17
            Delay 1000
        End Select

        Delay 1000
        f = f + 1
		
    	Form1.ListBox2.AddItem f
    Loop Until f = 17

//    MsgBox "NEXT CURRICULUM"
	Dim LOG97
    LOG97 = "国防课程遍历完成"
    Form1.ListBox2.AddItem LOG97
    
    Delay 800
    Call 课终评价
    Delay 800
    //zhu
    //四个章节都没有
    //去下一个课程

//国防
If MODE = 0 or MODE = 1 Then //国防优先组
//	M10携带码 = 3
//	Call 切换课程
	Delay 1000
	//关闭模拟器
	Dim LOG98
    LOG98 = "MODE0 MODE1自动化已完成"
    Form1.ListBox2.AddItem LOG98
    
    Dim LOG99
    LOG99 = "感谢您选择智慧树-知到自动化逆向工程"
    Form1.ListBox2.AddItem LOG99
    
	Call 关闭模拟器
	StopThread 线程ID2
	Delay 2000
	Dim LOGEND2
	LOGEND2 = "脚本被终止"
	Form1.ListBox2.AddItem LOGEND2
	MsgBox "脚本被终止"
	ExitScript
ElseIf MODE = 2 Then
//	M2携带码 = 3
//	Call 切换课程
	Delay 1000
	//关闭模拟器
	Dim LOG100
    LOG100 = "MODE2自动化已完成"
    Form1.ListBox2.AddItem LOG100
    
    Dim LOG101
    LOG101 = "感谢您选择智慧树-知到自动化逆向工程"
    Form1.ListBox2.AddItem LOG101
    
	Call 关闭模拟器	
	StopThread 线程ID2
	Delay 2000
	Dim LOGEND3
	LOGEND3 = "脚本被终止"
	Form1.ListBox2.AddItem LOGEND3
	MsgBox "脚本被终止"
	ExitScript
Else 
	Dim LOG102
    LOG102 = "切换至心理课"
    Form1.ListBox2.AddItem LOG102
//	M3携带码 = 1
	Call 切换课程
	Call 启动心理
End If

	
	
End Function

Sub 初始化国防


    Delay 1000
    //    MsgBox "wait"
    XYZt0 = Plugin.Bkgnd.FindPic(HD1, 9,490,63,600, "D:\按键精灵释放地址\未初始化Z1.bmp", 0, 0.6)
    iZBZt0 = InStr(XYZt0, "|")
    XZt0 = CLng(Left(XYZt0, iZBZt0 - 1))
    YZt0 = CLng(Right(XYZt0, Len(XYZt0) - iZBZt0))
    If XZt0 <> - 1  Then 
        TracePrint XZt0
        TracePrint YZt0
        //        	MsgBox "wait"
        Call Plugin.Bkgnd.LeftClick(HD2, 31,469)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ1"
    End If
    
    Dim LOG60
    LOG60 = "国防章节一已还原"
    Form1.ListBox2.AddItem LOG60

    Delay 1000

    XYZt = Plugin.Bkgnd.FindPic(HD1, 9,490,63,868, "D:\按键精灵释放地址\未初始化Z2.bmp", 0, 0.6)
    iZBZt = InStr(XYZt, "|")
    XZt = CLng(Left(XYZt, iZBZt - 1))
    YZt = CLng(Right(XYZt, Len(XYZt) - iZBZt))
    //XY = Plugin.Bkgnd.FindColor(HD1, 0, 0, 1024, 768, "797764")
    //ZB = InStr(XY, "|")
    //X = Clng(Left(XY, ZB - 1)): Y = Clng(Right(XY, Len(XY) - ZB))

    If XZt <> - 1  Then //有
        TracePrint XZt 
        TracePrint YZt
        Call Plugin.Bkgnd.LeftClick(HD2, 30,547)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ2"
    End If
    
    Dim LOG61
    LOG61 = "国防章节二已还原"
    Form1.ListBox2.AddItem LOG61

    Delay 1000

    XYZt1 = Plugin.Bkgnd.FindPic(HD1, 9,490,63,968, "D:\按键精灵释放地址\未初始化Z3.bmp", 0, 0.6)
    iZBZt1 = InStr(XYZt1, "|")
    XZt1 = CLng(Left(XYZt1, iZBZt1 - 1))
    YZt1 = CLng(Right(XYZt1, Len(XYZt1) - iZBZt1))
    If XZt1 <> - 1  Then 
        TracePrint XZt1
        TracePrint YZt1
        Call Plugin.Bkgnd.LeftClick(HD2, 31,618)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ3"
    End If
    
    Dim LOG62
    LOG62 = "国防章节三已还原"
    Form1.ListBox2.AddItem LOG62

    Delay 1000

    XYZt2 = Plugin.Bkgnd.FindPic(HD1, 9,490,63,968, "D:\按键精灵释放地址\未初始化Z4.bmp", 0, 0.6)
    iZBZt2 = InStr(XYZt2, "|")
    XZt2 = CLng(Left(XYZt2, iZBZt2 - 1))
    YZt2 = CLng(Right(XYZt2, Len(XYZt2) - iZBZt2))
    If XZt2 <> - 1  Then 
        TracePrint XZt2
        TracePrint YZt2
        Call Plugin.Bkgnd.LeftClick(HD2, 31,693)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ4"
    End If
    
    Dim LOG63
    LOG63 = "国防章节四已还原"
    Form1.ListBox2.AddItem LOG63
    
    
    Delay 1000

    XYZt3 = Plugin.Bkgnd.FindPic(HD1, 9,490,63,968, "D:\按键精灵释放地址\未初始化Z5.bmp", 0, 0.6)
    iZBZt3 = InStr(XYZt3, "|")
    XZt3 = CLng(Left(XYZt3, iZBZt3 - 1))
    YZt3 = CLng(Right(XYZt3, Len(XYZt3) - iZBZt3))
    If XZt3 <> - 1  Then 
        TracePrint XZt3
        TracePrint YZt3
        Call Plugin.Bkgnd.LeftClick(HD2, 31,765)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ5"
    End If
    
    Dim LOG64
    LOG64 = "国防章节五已还原"
    Form1.ListBox2.AddItem LOG64
        
    Delay 1000

    XYZt4 = Plugin.Bkgnd.FindPic(HD1, 9,490,63,968, "D:\按键精灵释放地址\未初始化Z6.bmp", 0, 0.6)
    iZBZt4 = InStr(XYZt4, "|")
    XZt4 = CLng(Left(XYZt4, iZBZt4 - 1))
    YZt4 = CLng(Right(XYZt4, Len(XYZt4) - iZBZt4))
    If XZt4 <> - 1  Then 
        TracePrint XZt4
        TracePrint YZt4
        Call Plugin.Bkgnd.LeftClick(HD2, 31,840)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ6"
    End If
    
    Dim LOG65
    LOG65 = "国防章节六已还原"
    Form1.ListBox2.AddItem LOG65
    
    Delay 1000

    XYZt5 = Plugin.Bkgnd.FindPic(HD1, 9,490,83,1200, "D:\按键精灵释放地址\未初始化Z7.bmp", 0, 0.6)
    iZBZt5 = InStr(XYZt5, "|")
    XZt5 = CLng(Left(XYZt5, iZBZt5 - 1))
    YZt5 = CLng(Right(XYZt5, Len(XYZt5) - iZBZt5))
    If XZt5 <> - 1  Then 
        TracePrint XZt5
        TracePrint YZt5
        Call Plugin.Bkgnd.LeftClick(HD2, 31,912)//点击收起箭头
        Delay 1000
    Else 
        //        MsgBox "nofoundQ7"
    End If
    
    Dim LOG66
    LOG66 = "国防章节七已还原"
    Form1.ListBox2.AddItem LOG66
    
    
    Delay 1000

    XYZt6 = Plugin.Bkgnd.FindPic(HD1, 9,490,83,1302+52, "D:\按键精灵释放地址\未初始化Z8.bmp", 0, 0.6)
    iZBZt6 = InStr(XYZt6, "|")
    XZt6 = CLng(Left(XYZt6, iZBZt6 - 1))
    YZt6 = CLng(Right(XYZt6, Len(XYZt6) - iZBZt6))
    If XZt6 <> - 1  Then 
        TracePrint XZt6
        TracePrint YZt6
        Call Plugin.Bkgnd.LeftClick(HD2, 31,988)//点击收起箭头
        Delay 1000
    Else 
//        MsgBox "nofoundQ8"
    End If
    
    Dim LOG67
    LOG67 = "国防章节八已还原"
    Form1.ListBox2.AddItem LOG67
    
    Delay 1000

    XYZt7 = Plugin.Bkgnd.FindPic(HD1, 9,490,83,1302+52, "D:\按键精灵释放地址\未初始化Z9.bmp", 0, 0.6)
    iZBZt7 = InStr(XYZt7, "|")
    XZt7 = CLng(Left(XYZt7, iZBZt7 - 1))
    YZt7 = CLng(Right(XYZt7, Len(XYZt7) - iZBZt7))
    If XZt7 <> - 1  Then 
        TracePrint XZt7
        TracePrint YZt7
        Call Plugin.Bkgnd.LeftClick(HD2, 31,1060)//点击收起箭头
        Delay 1000
    Else 
//        MsgBox "nofoundQ9"
    End If
    
    Dim LOG68
    LOG68 = "国防章节九已还原"
    Form1.ListBox2.AddItem LOG68
    
    Delay 1000

    XYZt8 = Plugin.Bkgnd.FindPic(HD1, 9,490,83,1302+52, "D:\按键精灵释放地址\未初始化Z10.bmp", 0, 0.8)
    iZBZt8 = InStr(XYZt8, "|")
    XZt8 = CLng(Left(XYZt8, iZBZt8 - 1))
    YZt8 = CLng(Right(XYZt8, Len(XYZt8) - iZBZt8))
    If XZt8 <> - 1  Then 
        TracePrint XZt8
        TracePrint YZt8
        Call Plugin.Bkgnd.LeftClick(HD2, 31,1132)//点击收起箭头
        Delay 1000
    Else 
//        MsgBox "nofoundQ10"
    End If
    
    Dim LOG69
    LOG69 = "国防章节十已还原"
    Form1.ListBox2.AddItem LOG69
    
    Delay 1000

    XYZt9 = Plugin.Bkgnd.FindPic(HD1, 9,490,83,1302+52, "D:\按键精灵释放地址\未初始化Z11.bmp", 0, 0.4)
    iZBZt9 = InStr(XYZt9, "|")
    XZt9 = CLng(Left(XYZt9, iZBZt9 - 1))
    YZt9 = CLng(Right(XYZt9, Len(XYZt9) - iZBZt9))
    If XZt9 <> - 1  Then 
        TracePrint XZt9
        TracePrint YZt9
        Call Plugin.Bkgnd.LeftClick(HD2, 31,1206)//点击收起箭头
        Delay 1000
    Else 
//        MsgBox "nofoundQ11"
    End If
    
    Dim LOG70
    LOG70 = "国防章节十一已还原"
    Form1.ListBox2.AddItem LOG70
    
    Delay 1000
    Call 滑动(Code, 367, 1149, 381, 567, 1000)//华东一次就够了
    
    Delay 1000

    XYZt10 = Plugin.Bkgnd.FindPic(HD1, 9,490,83,1302+52, "D:\按键精灵释放地址\未初始化Z12.bmp", 0, 0.4)
    iZBZt10 = InStr(XYZt10, "|")
    XZt10 = CLng(Left(XYZt10, iZBZt10 - 1))
    YZt10 = CLng(Right(XYZt10, Len(XYZt10) - iZBZt10))
    If XZt10 <> - 1  Then 
        TracePrint XZt10
        TracePrint YZt10
        Call Plugin.Bkgnd.LeftClick(HD2, XZt10+7,YZt10-52)//点击收起箭头
        Delay 1000
    Else 
//        MsgBox "nofoundQ12"
    End If
    
    Dim LOG71
    LOG71 = "国防章节十二已还原"
    Form1.ListBox2.AddItem LOG71
    
    Delay 1000

    XYZt11 = Plugin.Bkgnd.FindPic(HD1, 9,490,83,1302+52, "D:\按键精灵释放地址\未初始化Z13.bmp", 0, 0.4)
    iZBZt11 = InStr(XYZt11, "|")
    XZt11 = CLng(Left(XYZt11, iZBZt11 - 1))
    YZt11 = CLng(Right(XYZt11, Len(XYZt11) - iZBZt11))
    If XZt11 <> - 1  Then 
        TracePrint XZt11
        TracePrint YZt11
        Call Plugin.Bkgnd.LeftClick(HD2, XZt11+7,YZt11-52)//点击收起箭头
        Delay 1000
    Else 
//        MsgBox "nofoundQ13"
    End If
    
    Dim LOG72
    LOG72 = "国防章节十三已还原"
    Form1.ListBox2.AddItem LOG72
    
    Delay 1000

    XYZt12 = Plugin.Bkgnd.FindPic(HD1, 9,490,83,1302+52, "D:\按键精灵释放地址\未初始化Z14.bmp", 0, 0.4)
    iZBZt12 = InStr(XYZt12, "|")
    XZt12 = CLng(Left(XYZt12, iZBZt12 - 1))
    YZt12 = CLng(Right(XYZt12, Len(XYZt12) - iZBZt12))
    If XZt12 <> - 1  Then 
        TracePrint XZt12
        TracePrint YZt12
        Call Plugin.Bkgnd.LeftClick(HD2,XZt12+7,YZt12-52)//点击收起箭头
        Delay 1000
    Else 
//        MsgBox "nofoundQ14"
    End If
    
    Dim LOG73
    LOG73 = "国防章节十四已还原"
    Form1.ListBox2.AddItem LOG73
    
    Delay 1000

    XYZt13 = Plugin.Bkgnd.FindPic(HD1, 9,490,83,1302+52, "D:\按键精灵释放地址\未初始化Z15.bmp", 0, 0.4)
    iZBZt13 = InStr(XYZt13, "|")
    XZt13 = CLng(Left(XYZt13, iZBZt13 - 1))
    YZt13 = CLng(Right(XYZt13, Len(XYZt13) - iZBZt13))
    If XZt13 <> - 1  Then 
        TracePrint XZt13
        TracePrint YZt13
        Call Plugin.Bkgnd.LeftClick(HD2, XZt13+7,YZt13-52)//点击收起箭头
        Delay 1000
    Else 
//        MsgBox "nofoundQ15"
    End If
    
    Dim LOG74
    LOG74 = "国防章节十五已还原"
    Form1.ListBox2.AddItem LOG74
    
    Delay 1000

    XYZt14 = Plugin.Bkgnd.FindPic(HD1, 9,490,83,1302+52, "D:\按键精灵释放地址\未初始化Z16.bmp", 0, 0.4)
    iZBZt14 = InStr(XYZt14, "|")
    XZt14 = CLng(Left(XYZt14, iZBZt14 - 1))
    YZt14 = CLng(Right(XYZt14, Len(XYZt14) - iZBZt14))
    If XZt14 <> - 1  Then 
        TracePrint XZt14
        TracePrint YZt14
        Call Plugin.Bkgnd.LeftClick(HD2, XZt14+7,YZt14-52)//点击收起箭头
        Delay 1000
    Else 
//        MsgBox "nofoundQ16"
    End If
    
    Dim LOG75
    LOG75 = "国防章节十六已还原"
    Form1.ListBox2.AddItem LOG75
    
    Delay 1000

    XYZt15 = Plugin.Bkgnd.FindPic(HD1, 9,490,83,1302+52, "D:\按键精灵释放地址\未初始化Z17.bmp", 0, 0.4)
    iZBZt15 = InStr(XYZt15, "|")
    XZt15 = CLng(Left(XYZt15, iZBZt15 - 1))
    YZt15 = CLng(Right(XYZt15, Len(XYZt15) - iZBZt15))
    If XZt15 <> - 1  Then 
        TracePrint XZt15
        TracePrint YZt15
        Call Plugin.Bkgnd.LeftClick(HD2,XZt15+7,YZt15-52)//点击收起箭头
        Delay 1000
    Else 
//        MsgBox "nofoundQ17"
    End If
    
    Dim LOG76
    LOG76 = "国防章节十七已还原"
    Form1.ListBox2.AddItem LOG76
    
    For 5
        XYZt16 = Plugin.Bkgnd.FindPic(HD1, 9,490,83,1302+52, "D:\按键精灵释放地址\未初始化Z17.bmp", 0, 0.4)
        iZBZt16 = InStr(XYZt16, "|")
        XZt16 = CLng(Left(XYZt16, iZBZt16 - 1))
        YZt16 = CLng(Right(XYZt16, Len(XYZt16) - iZBZt16))
        If XZt16 <> - 1  Then 
            TracePrint XZt16
            TracePrint YZt16
            Call Plugin.Bkgnd.LeftClick(HD2,XZt16+7,YZt16-52)//点击收起箭头
            Delay 1000
        Else 
//            MsgBox "nofoundQ"
        End If
        Delay 500
    Next
    
End Sub





































Function 视频浏览
	PauseThread 线程ID3
    //    MsgBox "iii"
    Delay 1000
    Call Plugin.Bkgnd.LeftClick(HD2, 715, 224)//点击扩大界面
    Delay 1000
    //	Call Plugin.Bkgnd.LeftClick(HD2, 715, 224)//点击扩大界面

	Dim LOG104
    LOG104 = "横屏分辨率重置"
    Form1.ListBox2.AddItem LOG104
    
    Call Handle
    //    Call HP

	Dim LOG103
    LOG103 = "倍速调节"
    Form1.ListBox2.AddItem LOG103
    //	Call Plugin.Bkgnd.LeftClick(HD2, 54, 1038)//点击播放
    Delay 800
    Call Plugin.Bkgnd.LeftClick(HD2, 1645, 1045)//点击1.26倍速
    Delay 300
    Call Plugin.Bkgnd.LeftClick(HD2, 1645, 1045)//点击1.5倍速
    Delay 300
	
    //第二遍可能变道1.25倍速
    XY倍速 = Plugin.Bkgnd.FindColorEx(HD1, 1630, 1231, 1633, 1235, "F6F7F8", 0, 0.9)
    ZB倍速 = InStr(XY倍速, "|")
    X倍速 = Clng(Left(XY倍速, ZB倍速 - 1)): Y倍速 = Clng(Right(XY倍速, Len(XY倍速) - ZB倍速))
    If X倍速 <> - 1  Then //1.25被
//                MsgBox "1.25X"
//       MsgBox "1.25X"
		TracePrint X倍速 & " " & Y倍速
        Call Plugin.Bkgnd.LeftClick(HD2, 1645, 1045)//点击1.5倍速
    End If
    
    XY倍速P = Plugin.Bkgnd.FindColorEx(HD1, 1646, 1238, 1649, 1242, "F9F9F9", 0, 0.97)
	ZB倍速P = InStr(XY倍速P, "|")
	X倍速P = Clng(Left(XY倍速P, ZB倍速P - 1)): Y倍速P = Clng(Right(XY倍速P, Len(XY倍速P) - ZB倍速P))
	If X倍速P <> - 1  Then //如果找到了就不是1.0
	Else
//                MsgBox "1.0"
        Delay 800
    	Call Plugin.Bkgnd.LeftClick(HD2, 1645, 1045)//点击1.26倍速
    	Delay 300
    	Call Plugin.Bkgnd.LeftClick(HD2, 1645, 1045)//点击1.5倍速
    	Delay 300
    End If
    
	
    Delay 800
    Call Plugin.Bkgnd.LeftClick(HD2, 43, 45)//点击返回
    Delay 3000
    
    ContinueThread 线程ID3
    // 竖屏调用
    Call Handle
	
	Dim LOG105
    LOG105 = "竖屏分辨率重置"
    Form1.ListBox2.AddItem LOG105
	
	

    Delay 500
    Do
        //做大检测
    	XYQUE = Plugin.Bkgnd.FindColorEx(HD1, 39, 181, 163, 276, "91CC29", 0, 0.8)
		ZBQUE = InStr(XYQUE, "|")
		XQUE = Clng(Left(XYQUE, ZBQUE - 1)): YQUE = Clng(Right(XYQUE, Len(XYQUE) - ZBQUE))
		If XQUE <> - 1  Then 
//			MsgBox "answer"
			Dim LOG107
   		    LOG107 = "调用作答程序"
    		Form1.ListBox2.AddItem LOG107
            Delay 1000
            Call 作答
		Else 
		End If

//        
//        GetColor2 = Plugin.Bkgnd.GetPixelColor(HD1, 141, 343)
//        TracePrint GetColor2
//        If GetColor2 = "FBF8F5" Then //出现问题
//            //            MsgBox "er"
//            Dim LOG107
//   		    LOG107 = "调用作答程序"
//    		Form1.ListBox2.AddItem LOG107
//            Delay 1000
//            Call 作答
//        ELse
//        End If

		XY弹窗 = Plugin.Bkgnd.FindColorEx(HD1, 406, 344+52, 683, 447+52, "7CDE6C", 0, 0.99)
		ZB弹窗 = InStr(XY弹窗, "|")
		X弹窗 = Clng(Left(XY弹窗, ZB弹窗 - 1)): Y弹窗 = Clng(Right(XY弹窗, Len(XY弹窗) - ZB弹窗))
		If X弹窗 <> - 1  Then 
 		TracePrint X弹窗
 		TracePrint Y弹窗
 		Call Plugin.Bkgnd.LeftClick(HD2, 368, 941)//点击屏幕
 		Delay 800
 		End if
		
        GetColor3 = Plugin.Bkgnd.GetPixelColor(HD1, 370, 134)
        //TracePrint GetColor3
    Loop Until GetColor3 = "8FACD9"
	
	Dim LOG106
    LOG106 = "视频浏览完成"
    Form1.ListBox2.AddItem LOG106
	
    Call Plugin.Bkgnd.LeftClick(HD2, 396, 137)//点击屏幕
    Delay 400
    Call Plugin.Bkgnd.LeftClick(HD2, 1645, 1045)//点击暂停
    Delay 800
    Call 课终评价
    //    MsgBox "over"
End Function

Function 作答
    Delay 1000
    Call Plugin.Bkgnd.LeftClick(HD2, 190, 314)//点击A
    Delay 2000
    Call Plugin.Bkgnd.LeftClick(HD2, 660, 172)//点击叉
    Delay 700
    
    //检测卡死
    Do
    XY卡住 = Plugin.Bkgnd.FindColorEx(HD1, 645, 157+52, 676, 184+52, "B89B97", 0, 0.9)
	ZB卡住 = InStr(XY卡住, "|")
	X卡住 = Clng(Left(XY卡住, ZB卡住 - 1)): Y卡住 = Clng(Right(XY卡住, Len(XY卡住) - ZB卡住))
	
	If X失败过多 <> - 1  Then //弹窗还在
		Call Plugin.Bkgnd.LeftClick(HD2, 661, 172)
	
	TracePrint X卡住
	TracePrint Y卡住
	End If
	//Delay 3000
	//	MsgBox "que"
	Loop Until X卡住 = - 1
End Function

Function 平滑移动鼠标to(终点坐标px, 终点坐标py, 移动时间, 起点坐标beginx, 起点坐标beginy, 平滑灵敏度)
    //Call Plugin.Bkgnd.LeftClick(HD2, 起点坐标beginx, 起点坐标beginy)//点击记忆隙间
    Call Plugin.Bkgnd.LeftDown(HD2, 起点坐标beginx, 起点坐标beginy)
    //Delay 800
    dim mx
    dim x,y
    dim tx,ty
    x=起点坐标beginx
    y=起点坐标beginy
    tx=abs(x-终点坐标px)


    ty=abs(y-终点坐标py)
    if tx>=ty
        mx=tx
    else
        mx=ty
    end if
    if mx>0
        for i = 0 to mx step 平滑灵敏度
            sx=int((终点坐标px*i+x*(mx-i))/mx)
            sy=int((终点坐标py*i+y*(mx-i))/mx)
            Call Plugin.Bkgnd.MoveTo(HD2, sx, sy)
            delay int(移动时间/mx*平滑灵敏度)
        Next
    else
        delay 移动时间
    end if
    Call Plugin.Bkgnd.MoveTo(HD2,终点坐标px, 终点坐标py)
    平滑移动鼠标to = true
    Call Plugin.Bkgnd.LeftUp(HD2, 终点坐标beginx, 终点坐标beginy)
    Delay 800
End Function


Function ExtractPathSimplified
	Dim LOG108
    LOG108 = "路径截取处理"
    Form1.ListBox2.AddItem LOG108
    
    Dim lastSlash 

    ' 找到最后一个反斜杠的位置
    lastSlash = InStrRev(APPROUTE, "\")
    
    ' 提取路径并去除最后一个反斜杠
    If lastSlash > 1 Then
        ADR2 = Left(APPROUTE, lastSlash - 1)
    Else
        ADR2 = APPROUTE
    End If
    
    ' 输出结果
    TracePrint ADR2
//        MsgBox ADR2
    Delay 1000
End Function

//Call 滑动(0, 367, 1149, 754, 266, 867)
Function 滑动(Code, X1, Y1, X2, Y2, S)
    X1 = X1 + 150: Y1 = Y1 +150: X2 = X2 + 150: Y2 = Y2 +150
    命令 = "shell input swipe " & X1 & " " & Y1 & " " & X2 & " " & Y2 & " " & S
    命令 = """" & 命令 & """"
    TracePrint 命令

    Call ExtractPathSimplified
    路径 = "D:&&CD " & ADR2
    //D:\MuMu Player 12\shell
    //路径 = "D:&&CD D:\工程\MuMu Player 12\shell"
    命令行 = 路径 & "&&MuMuManager.exe adb -v " & Code & " -c " & 命令
//msgbox 命令行
    TracePrint 命令行
    Plugin.SMWH.GetDOS 命令行
End Function


Function 切换课程
	Dim LOG29
    LOG29 = "调用切换课程"
    Form1.ListBox2.AddItem LOG29
    //检测人机
	StopThread 线程ID3
	
//MsgBox "insed"
Code = Form1.InputBox6.Text
//关闭软件
Call ExtractPathSimplified//得到ADR2 shell的地址
路径b = "D:&&CD "& ADR2
命令行b = 路径b & "&&MuMuManager.exe api -v "& Code &" close_app com.able.wisdomtree"
Plugin.SMWH.GetDOS 命令行b,20000

	Dim LOG30
    LOG30 = "重启APP"
    Form1.ListBox2.AddItem LOG30
Delay 2000

Call Handle
Call HP

Delay 1000

	Do
    XY广告 = Plugin.Bkgnd.FindColor(HD1, 1696, 146+200, 1754, 205+200, "FFBF02")
	ZB广告 = InStr(XY广告, "|")
	X广告 = Clng(Left(XY广告, ZB广告 - 1)): Y广告 = Clng(Right(XY广告, Len(XY广告) - ZB广告))
	
    XY0 = Plugin.Bkgnd.FindColor(HD1, 255, 486, 290, 501, "FFA300")
    ZB0 = InStr(XY0, "|")
    X0 = Clng(Left(XY0, ZB0 - 1)) : Y0 = Clng(Right(XY0, Len(XY0) - ZB0))
    TracePrint X0
    TracePrint Y0
        
    Loop Until X0 <> - 1  or X广告 <> - 1 
    
    If X广告 <> - 1  Then 
		Call Plugin.Bkgnd.LeftClick(HD2, 1729, 176)//点击下箭头
  		TracePrint X广告
  		TracePrint Y广告
		//	MsgBox "find"
	End If
	
	//更新热检测
	HwndK = Plugin.Window.Find("Qt5156QWindow", "MuMu更新")
    HDK = HwndK
    TracePrint HDK
    If HDK <> 0 Then 
    	Call Plugin.Bkgnd.LeftClick(HDK, 505, 556)//点击暂不更新
    	Dim LOG120
   		LOG120 = "暂不更新"
   		Form1.ListBox2.AddItem LOG120
//    	MsgBox "renew"
    End If

    //启动软件
    Call ExtractPathSimplified//得到ADR2 shell的地址
//    MsgBox ADR2
    Delay 1000
    路径a = "D:&&CD " & ADR2
//    MsgBox 路径a
    命令行a = 路径a & "&&MuMuManager.exe api -v "& Code &" launch_app com.able.wisdomtree"
//    MsgBox 命令行a
    Plugin.SMWH.GetDOS 命令行a,20000

    Delay 10000
    Do
    	XYP1 = Plugin.Bkgnd.FindColorEx(HD1, 906, 124+200, 1060, 270+200, "EEC25F", 0, 0.8)
		ZBP1 = InStr(XYP1, "|")
		XP1 = Clng(Left(XYP1, ZBP1 - 1)) : YP1 = Clng(Right(XYP1, Len(XYP1) - ZBP1))
		
        XY检色 = Plugin.Bkgnd.FindColorEx(HD1, 1869, 310, 1871, 312, "2E2D2A", 0, 0.9)
		ZB检色 = InStr(XY检色, "|")
		X检色 = Clng(Left(XY检色, ZB检色 - 1)) : Y检色 = Clng(Right(XY检色, Len(XY检色) - ZB检色))
		Dim LOG201
    	LOG201 = "检色1"
    	Form1.ListBox2.AddItem LOG201
    Loop Until X检色 <> - 1  or XP1 <> - 1 
    
    

	Delay 1000
//	MsgBox "done"
	
	If XP1 <> - 1  Then 
//		MsgBox "cansel"
		Call Plugin.Bkgnd.LeftClick(HD2, 1237, 234)//点击取消
//		MsgBox "cancel"
	End If
	
	Delay 1000
	
	Do
        XY检色C = Plugin.Bkgnd.FindColorEx(HD1, 1869, 310, 1871, 312, "2E2D2A", 0, 0.9)
		ZB检色C = InStr(XY检色C, "|")
		X检色C = Clng(Left(XY检色C, ZB检色C - 1)) : Y检色C = Clng(Right(XY检色C, Len(XY检色C) - ZB检色C))
		Dim LOG209
    	LOG209 = "检色2"
    	Form1.ListBox2.AddItem LOG209
    Loop Until X检色C <> - 1 
	
	If X检色C <> - 1  Then 
		Delay 3000
    	Call Plugin.Bkgnd.LeftClick(HD2, 227, 122)//点击学习
	End If
	
	Delay 3000



//判断下一个选择什么
//MODE1 0 携带码0 心理(+1)=1 道法（+1）=2 国防(+1)=3
//MODE2    道法 心理 国防
//MODE3    国防 心理 道法
//If MODE = 0 or MODE = 1 Then 
//	Select Case M10携带码
//		Case 1//上完心理
//			Call 启动思政
//		Case 2
//			Call 启动国防
//		Case 3//全上完了
//			//关闭模拟器
//			Call 关闭模拟器
//		
//			StopThread 线程ID2
//			Delay 2000
//			Dim LOGEND
//			LOGEND = "脚本被终止"
//			Form1.ListBox2.AddItem LOGEND
//			MsgBox "脚本被终止"
//			ExitScript
//	End Select
//	
//ElseIf MODE = 2 Then
//		Select Case M2携带码
//	Case 1//上完道法
//		Call 启动心理
//	Case 2
//		Call 启动国防
//	Case 3//全上完了
//		//关闭模拟器
//		Call 关闭模拟器
//			
//		StopThread 线程ID2
//		Delay 2000
//		Dim LOGEND1
//		LOGEND1 = "脚本被终止"
//		Form1.ListBox2.AddItem LOGEND1
//		MsgBox "脚本被终止"
//		ExitScript
//	End Select
//
//Else 
//	Select Case M3携带码
//		Case 1//上完国防
//			Call 启动心理
//		Case 2
//			Call 启动思政
//		Case 3//全上完了
//			//关闭模拟器
//			Call 关闭模拟器
//			
//			StopThread 线程ID2
//			Delay 2000
//			Dim LOGEND2
//			LOGEND2 = "脚本被终止"
//			Form1.ListBox2.AddItem LOGEND2
//			MsgBox "脚本被终止"
//		ExitScript
//	End Select
//
//End If

End Function

Function 关闭模拟器
	Dim LOG109
    LOG109 = "正在关闭模拟器..."
    Form1.ListBox2.AddItem LOG109
    
Call ExtractPathSimplified//得到ADR2 shell的地址
Delay 1000
//	Code = Form1.InputBox6.Text
	Call ExtractPathSimplified//得到ADR2 shell的地址
	Code = Form1.InputBox6.Text
	路径c = "D:&&CD "& ADR2
	命令行c = 路径c & "&&MuMuManager.exe api -v " & Code & " shutdown_player"
	Plugin.SMWH.GetDOS 命令行c,20000
End Function

Function 课终评价
	XY过半反 = Plugin.Bkgnd.FindColor(HD1, 859, 723+200, 1079, 788+200, "96C800")
	ZB过半反 = InStr(XY过半反, "|")
	X过半反 = Clng(Left(XY过半反, ZB过半反 - 1)) : Y过半反 = Clng(Right(XY过半反, Len(XY过半反) - ZB过半反))//防止检测为课终评价
	If X过半反 <> - 1  Then //出现课终评价
		Delay 1000
		MsgBox "课程结束评价 与实际分数挂钩 代理结束"
		Dim LOGEND2
		LOGEND2 = "程序终止"
		Form1.ListBox2.AddItem LOGEND2
		ExitScript
	End If
End Function

Function 证书弹窗
	Dim LOG113
    LOG113 = "证书弹窗处理"
    Form1.ListBox2.AddItem LOG113
	XY过半 = Plugin.Bkgnd.FindColorEx(HD1, 1101+52, 959, 1365, 1075+52, "1C6BF7", 0, 0.8)
	ZB过半 = InStr(XY过半, "|")
	X过半 = Clng(Left(XY过半, ZB过半 - 1)) : Y过半 = Clng(Right(XY过半, Len(XY过半) - ZB过半))
	
	XY过半反 = Plugin.Bkgnd.FindColor(HD1, 859, 723+200, 1079, 788+200, "96C800")
	ZB过半反 = InStr(XY过半反, "|")
	X过半反 = Clng(Left(XY过半反, ZB过半反 - 1)) : Y过半反 = Clng(Right(XY过半反, Len(XY过半反) - ZB过半反))//防止检测为课终评价

If X过半 <> - 1 and X过半反 = -1 Then //出现证书
	Delay 1000
	Call Plugin.Bkgnd.LeftClick(HD2, 1872, 109)
	Delay 800
	Call Plugin.Bkgnd.LeftClick(HD2, 811, 587)
	Delay 3000
Else 

End If
End Function

Sub 检测人机
//MsgBox "实时人机检测启动"
Rem Recheck
Call Handle
Do
//Call Handle
XY处理 = Plugin.Bkgnd.FindColorEx(HD1, 512, 568+52, 546, 606+52, "C9C9C9", 0, 0.97)
ZB处理 = InStr(XY处理, "|")
X处理 = Clng(Left(XY处理, ZB处理 - 1)) : Y处理 = Clng(Right(XY处理, Len(XY处理) - ZB处理))

XY处理1 = Plugin.Bkgnd.FindColorEx(HD1, 509, 605+52, 545, 617+52, "E6E6E6", 0, 0.97)
ZB处理1 = InStr(XY处理1, "|")
X处理1 = Clng(Left(XY处理1, ZB处理1 - 1)) : Y处理1 = Clng(Right(XY处理1, Len(XY处理1) - ZB处理1))
//TracePrint X处理 & " " & Y处理
//TracePrint X处理1 & " " & Y处理1


Loop Until X处理 <> - 1 and X处理1 <> -1
//	MsgBox "test"
	PauseThread 线程ID2
	Dim LOG111
    LOG111 = "人机验证破解开始"
    Form1.ListBox2.AddItem LOG111
//    MsgBox X处理
//    MsgBox Y处理
//    MsgBox "人机验证破解开始"
	Call 处理图像

Delay 600

Goto Recheck
End Sub



//都概率
Function 处理图像
Do
//MsgBox "验证开始"
	Dim LOG112
    LOG112 = "开始处理图像"
    Form1.ListBox2.AddItem LOG112
//	如果次数太多就会跳出是否手机验证
//Loop
XYver = Plugin.Bkgnd.FindColorEx(HD1, 512, 568+52, 546, 606+52, "C9C9C9", 0, 0.9)//如果验证出现 还在
ZBver = InStr(XYver, "|")
Xver = Clng(Left(XYver, ZBver - 1)) : Yver = Clng(Right(XYver, Len(XYver) - ZBver))

If Xver = - 1  Then 
	Exit Do
End If

Dim startX, startY, endX, endY, stepSize
Dim currentX, currentY
Dim targetColor
Dim foundX, foundY

' 设置区域范围
startX = 230
startY = 627
endX = 496
endY = 720

' 设置步长
stepSize = 5

' 设置目标颜色
targetColor = "E6E6E6"

' 初始化找到的坐标
foundX = -1
foundY = -1

' 遍历指定区域
For currentY = startY To endY Step stepSize
    For currentX = startX To endX Step stepSize
        ' 获取当前坐标的颜色
        Dim currentColor
        currentColor = Plugin.Bkgnd.GetPixelColor(HD1,currentX, currentY)
        
        
        ' 检查颜色是否等于目标颜色
        If currentColor <> targetColor Then
            foundX = currentX
            foundY = currentY
            Exit For ' 找到不同颜色后退出内层循环
        End If
    Next
    If foundX <> -1 And foundY <> -1 Then
        Exit For ' 找到不同颜色后退出外层循环
    End If
Next

' 检查是否找到了不同颜色的点
If foundX <> - 1  And foundY <> - 1  Then 
	TracePrint currentColor
	Call Plugin.Bkgnd.LeftClick(HD2, foundX, foundY)//点击不同颜色
//    MsgBox "dianji at (" & foundX & ", " & foundY & ")"
Else
//    MsgBox "No different color found"
End If


	Delay 3000
	
	XY更换验证 = Plugin.Bkgnd.FindColorEx(HD1, 477, 712+52, 597, 754+52, "95D56A", 0, 0.9)//看看爆不爆更换验证
	ZB更换验证 = InStr(XY更换验证, "|")
	X更换验证 = Clng(Left(XY更换验证, ZB更换验证 - 1)): Y更换验证 = Clng(Right(XY更换验证, Len(XY更换验证) - ZB更换验证))
	
	If X更换验证 <> - 1  Then 
		Call Plugin.Bkgnd.LeftClick(HD2, 203, 728)//点击
		TracePrint X更换验证
		TracePrint Y更换验证
	Delay 3000
	//	MsgBox "que"
	End If
	
	XY失败过多 = Plugin.Bkgnd.FindColorEx(HD1, 277, 779+52, 297, 801+52, "6767F0", 0, 0.9)
	ZB失败过多 = InStr(XY失败过多, "|")
	X失败过多 = Clng(Left(XY失败过多, ZB失败过多 - 1)): Y失败过多 = Clng(Right(XY失败过多, Len(XY失败过多) - ZB失败过多))
	
	If X失败过多 <> - 1  Then 
		Call Plugin.Bkgnd.LeftClick(HD2, 289, 787)
		TracePrint X失败过多
		TracePrint Y失败过多
	Delay 3000
	//	MsgBox "que"
	End If
	
	//大概率一次不过
//	Call Plugin.Bkgnd.LeftClick(HD2, foundX, foundY)//点击下面验证！！！！！！！
Loop Until Xver = - 1 

	Dim LOG110
    LOG110 = "人机验证通过"
    Form1.ListBox2.AddItem LOG110
        
//MsgBox "成功验证"

//继续线程执行
ContinueThread 线程ID2

End Function
